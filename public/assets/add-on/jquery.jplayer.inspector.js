/*
 * jPlayerInspector Plugin for jPlayer (2.0.0+) Plugin for jQuery JavaScript Library
 * http://www.happyworm.com/jquery/jplayer
 *
 * Copyright (c) 2009 - 2011 Happyworm Ltd
 * Dual licensed under the MIT and GPL licenses.
 *  - http://www.opensource.org/licenses/mit-license.php
 *  - http://www.gnu.org/copyleft/gpl.html
 *
 * Author: Mark J Panaghiston
 * Version: 1.0.3
 * Date: 7th August 2011
 *
 * For use with jPlayer Version: 2.0.29
 *
 * Note: Declare inspector instances after jPlayer instances. ie., Otherwise the jPlayer instance is nonsense.
 */
(function(a,b){a.jPlayerInspector={},a.jPlayerInspector.i=0,a.jPlayerInspector.defaults={jPlayer:b,idPrefix:"jplayer_inspector_",visible:!1};var c={init:function(b){var c=this,d=a(this),e=a.extend({},a.jPlayerInspector.defaults,b);a(this).data("jPlayerInspector",e),e.id=a(this).attr("id"),e.jPlayerId=e.jPlayer.attr("id"),e.windowId=e.idPrefix+"window_"+a.jPlayerInspector.i,e.statusId=e.idPrefix+"status_"+a.jPlayerInspector.i,e.configId=e.idPrefix+"config_"+a.jPlayerInspector.i,e.toggleId=e.idPrefix+"toggle_"+a.jPlayerInspector.i,e.eventResetId=e.idPrefix+"event_reset_"+a.jPlayerInspector.i,e.updateId=e.idPrefix+"update_"+a.jPlayerInspector.i,e.eventWindowId=e.idPrefix+"event_window_"+a.jPlayerInspector.i,e.eventId={},e.eventJq={},e.eventTimeout={},e.eventOccurrence={},a.each(a.jPlayer.event,function(b,c){e.eventId[c]=e.idPrefix+"event_"+b+"_"+a.jPlayerInspector.i,e.eventOccurrence[c]=0});var f='<p><a href="#" id="'+e.toggleId+'">'+(e.visible?"Hide":"Show")+"</a> jPlayer Inspector</p>"+'<div id="'+e.windowId+'">'+'<div id="'+e.statusId+'"></div>'+'<div id="'+e.eventWindowId+'" style="padding:5px 5px 0 5px;background-color:#eee;border:1px dotted #000;">'+'<p style="margin:0 0 10px 0;"><strong>jPlayer events that have occurred over the past 1 second:</strong>'+'<br />(Backgrounds: <span style="padding:0 5px;background-color:#eee;border:1px dotted #000;">Never occurred</span> <span style="padding:0 5px;background-color:#fff;border:1px dotted #000;">Occurred before</span> <span style="padding:0 5px;background-color:#9f9;border:1px dotted #000;">Occurred</span> <span style="padding:0 5px;background-color:#ff9;border:1px dotted #000;">Multiple occurrences</span> <a href="#" id="'+e.eventResetId+'">reset</a>)</p>',g="float:left;margin:0 5px 5px 0;padding:0 5px;border:1px dotted #000;";return f+='<div id="'+e.eventId[a.jPlayer.event.ready]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.flashreset]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.resize]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.repeat]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.click]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.error]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.warning]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.loadstart]+'" style="clear:left;'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.progress]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.timeupdate]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.volumechange]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.play]+'" style="clear:left;'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.pause]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.waiting]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.playing]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.seeking]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.seeked]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.ended]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.loadeddata]+'" style="clear:left;'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.loadedmetadata]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.canplay]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.canplaythrough]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.suspend]+'" style="clear:left;'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.abort]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.emptied]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.stalled]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.ratechange]+'" style="'+g+'"></div>'+'<div id="'+e.eventId[a.jPlayer.event.durationchange]+'" style="'+g+'"></div>'+'<div style="clear:both"></div>',f+='</div><p><a href="#" id="'+e.updateId+'">Update</a> jPlayer Inspector</p>'+'<div id="'+e.configId+'"></div>'+"</div>",a(this).html(f),e.windowJq=a("#"+e.windowId),e.statusJq=a("#"+e.statusId),e.configJq=a("#"+e.configId),e.toggleJq=a("#"+e.toggleId),e.eventResetJq=a("#"+e.eventResetId),e.updateJq=a("#"+e.updateId),a.each(a.jPlayer.event,function(b,c){e.eventJq[c]=a("#"+e.eventId[c]),e.eventJq[c].text(b+" ("+e.eventOccurrence[c]+")"),e.jPlayer.bind(c+".jPlayerInspector",function(a){e.eventOccurrence[a.type]++,e.eventOccurrence[a.type]>1?e.eventJq[a.type].css("background-color","#ff9"):e.eventJq[a.type].css("background-color","#9f9"),e.eventJq[a.type].text(b+" ("+e.eventOccurrence[a.type]+")"),clearTimeout(e.eventTimeout[a.type]),e.eventTimeout[a.type]=setTimeout(function(){e.eventJq[a.type].css("background-color","#fff")},1e3),setTimeout(function(){e.eventOccurrence[a.type]--,e.eventJq[a.type].text(b+" ("+e.eventOccurrence[a.type]+")")},1e3),e.visible&&d.jPlayerInspector("updateStatus")})}),e.jPlayer.bind(a.jPlayer.event.ready+".jPlayerInspector",function(a){d.jPlayerInspector("updateConfig")}),e.toggleJq.click(function(){return e.visible?(a(this).text("Show"),e.windowJq.hide(),e.statusJq.empty(),e.configJq.empty()):(a(this).text("Hide"),e.windowJq.show(),e.updateJq.click()),e.visible=!e.visible,a(this).blur(),!1}),e.eventResetJq.click(function(){return a.each(a.jPlayer.event,function(a,b){e.eventJq[b].css("background-color","#eee")}),a(this).blur(),!1}),e.updateJq.click(function(){return d.jPlayerInspector("updateStatus"),d.jPlayerInspector("updateConfig"),!1}),e.visible||e.windowJq.hide(),a.jPlayerInspector.i++,this},destroy:function(){a(this).data("jPlayerInspector")&&a(this).data("jPlayerInspector").jPlayer.unbind(".jPlayerInspector"),a(this).empty()},updateConfig:function(){var b="<p>This jPlayer instance is running in your browser where:<br />";for(i=0;i<a(this).data("jPlayerInspector").jPlayer.data("jPlayer").solutions.length;i++){var c=a(this).data("jPlayerInspector").jPlayer.data("jPlayer").solutions[i];b+="&nbsp;jPlayer's <strong>"+c+"</strong> solution is";if(a(this).data("jPlayerInspector").jPlayer.data("jPlayer")[c].used){b+=" being <strong>used</strong> and will support:<strong>";for(format in a(this).data("jPlayerInspector").jPlayer.data("jPlayer")[c].support)a(this).data("jPlayerInspector").jPlayer.data("jPlayer")[c].support[format]&&(b+=" "+format);b+="</strong><br />"}else b+=" <strong>not required</strong><br />"}b+="</p>",a(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.active?a(this).data("jPlayerInspector").jPlayer.data("jPlayer").flash.active?b+="<strong>Problem with jPlayer since both HTML5 and Flash are active.</strong>":b+="The <strong>HTML5 is active</strong>.":a(this).data("jPlayerInspector").jPlayer.data("jPlayer").flash.active?b+="The <strong>Flash is active</strong>.":b+="No solution is currently active. jPlayer needs a setMedia().",b+="</p>";var d=a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.formatType;b+="<p><code>status.formatType = '"+d+"'</code><br />",d?b+="<code>Browser canPlay('"+a.jPlayer.prototype.format[d].codec+"')</code>":b+="</p>",b+="<p><code>status.src = '"+a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.src+"'</code></p>",b+="<p><code>status.media = {<br />";for(prop in a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.media)b+="&nbsp;"+prop+": "+a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.media[prop]+"<br />";b+="};</code></p><p>Raw browser test for HTML5 support. Should equal a function if HTML5 is available.<br />",a(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.audio.available&&(b+="<code>htmlElement.audio.canPlayType = "+typeof a(this).data("jPlayerInspector").jPlayer.data("jPlayer").htmlElement.audio.canPlayType+"</code><br />"),a(this).data("jPlayerInspector").jPlayer.data("jPlayer").html.video.available&&(b+="<code>htmlElement.video.canPlayType = "+typeof a(this).data("jPlayerInspector").jPlayer.data("jPlayer").htmlElement.video.canPlayType+"</code>"),b+="</p>",b+="<p>This instance is using the constructor options:<br /><code>$('#"+a(this).data("jPlayerInspector").jPlayer.data("jPlayer").internal.self.id+"').jPlayer({<br />"+"&nbsp;swfPath: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","swfPath")+"',<br />"+"&nbsp;solution: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","solution")+"',<br />"+"&nbsp;supplied: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","supplied")+"',<br />"+"&nbsp;preload: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","preload")+"',<br />"+"&nbsp;volume: "+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","volume")+",<br />"+"&nbsp;muted: "+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","muted")+",<br />"+"&nbsp;backgroundColor: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","backgroundColor")+"',<br />"+"&nbsp;cssSelectorAncestor: '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","cssSelectorAncestor")+"',<br />"+"&nbsp;cssSelector: {";var e=a(this).data("jPlayerInspector").jPlayer.jPlayer("option","cssSelector");for(prop in e)b+="<br />&nbsp;&nbsp;"+prop+": '"+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","cssSelector."+prop)+"',";return b=b.slice(0,-1),b+="<br />&nbsp;},<br />&nbsp;errorAlerts: "+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","errorAlerts")+",<br />"+"&nbsp;warningAlerts: "+a(this).data("jPlayerInspector").jPlayer.jPlayer("option","warningAlerts")+"<br />"+"});</code></p>",a(this).data("jPlayerInspector").configJq.html(b),this},updateStatus:function(){return a(this).data("jPlayerInspector").statusJq.html("<p>jPlayer is "+(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.paused?"paused":"playing")+" at time: "+Math.floor(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentTime*10)/10+"s."+" (d: "+Math.floor(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.duration*10)/10+"s"+", sp: "+Math.floor(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.seekPercent)+"%"+", cpr: "+Math.floor(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentPercentRelative)+"%"+", cpa: "+Math.floor(a(this).data("jPlayerInspector").jPlayer.data("jPlayer").status.currentPercentAbsolute)+"%)</p>"),this}};a.fn.jPlayerInspector=function(b){if(c[b])return c[b].apply(this,Array.prototype.slice.call(arguments,1));if(typeof b=="object"||!b)return c.init.apply(this,arguments);a.error("Method "+b+" does not exist on jQuery.jPlayerInspector")}})(jQuery);